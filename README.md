# VitPose Video Analysis πƒβ€β™‚οΈ

λΉ„λ””μ¤μ—μ„ μΈκ°„μ ν¬μ¦λ¥Ό λ¶„μ„ν•κ³  ν‚¤ν¬μΈνΈλ¥Ό μ¶”μ¶ν•λ” Gradio κΈ°λ° μ›Ή μ• ν”λ¦¬μΌ€μ΄μ…μ…λ‹λ‹¤. VitPose λ¨λΈμ„ μ‚¬μ©ν•μ—¬ 133κ° ν‚¤ν¬μΈνΈ(Whole Body)λ¥Ό μ‹¤μ‹κ°„μΌλ΅ μ¶”μ¶ν•κ³  μ‹κ°ν™”ν•©λ‹λ‹¤.

## μ£Όμ” κΈ°λ¥ β¨

- π“Ή **λΉ„λ””μ¤ μ—…λ΅λ“ λ° ν¬μ¦ λ¶„μ„**: MP4 λΉ„λ””μ¤ νμΌμ—μ„ μΈκ°„μ ν¬μ¦λ¥Ό μλ™μΌλ΅ κ²€μ¶
- π― **μ‹¤μ‹κ°„ ν‚¤ν¬μΈνΈ μ‹κ°ν™”**: 133κ° ν‚¤ν¬μΈνΈμ™€ μ¤μΌλ ν†¤μ„ μ‹¤μ‹κ°„μΌλ΅ ν‘μ‹
- β° **μ‹κ°„ μ—°λ™ νƒμƒ‰**: μ‹κ°„ μ¬λΌμ΄λ”μ™€ μ¬μƒ κΈ°λ¥μΌλ΅ μ›ν•λ” μ‹μ μ ν‚¤ν¬μΈνΈλ¥Ό μ‹¤μ‹κ°„μΌλ΅ ν™•μΈ
- π’Ύ **λ°μ΄ν„° μ¶λ ¥**: JSONκ³Ό CSV ν•μ‹μΌλ΅ ν¬μ¦ λ°μ΄ν„°λ¥Ό λ‚΄λ³΄λ‚΄κΈ°
- π“ **μ‹¤μ‹κ°„ ν”„λ΅κ·Έλ μ¤**: λΉ„λ””μ¤ μ²λ¦¬ μ§„ν–‰μƒν™©μ„ ν”„λ΅κ·Έλ μ¤ λ°”λ΅ μ‹¤μ‹κ°„ ν™•μΈ
- π” **JSON λ°μ΄ν„° λ·°μ–΄**: ν¬μ¦ λ°μ΄ν„°λ¥Ό μ‹¤μ‹κ°„μΌλ΅ νƒμƒ‰ν•κ³  ν™•μ¥/μ¶•μ† κ°€λ¥
- π“‹ **λ΅κ·Έ μ‹μ¤ν…**: μ²λ¦¬ κ³Όμ •μ„ μ‹¤μ‹κ°„μΌλ΅ μ¶”μ ν•κ³  κ΄€λ¦¬
- π€ **μ„±λ¥ μµμ ν™”**: μ‚¬λ κ²€μ¶ μµμ ν™”λ΅ μ²λ¦¬ μ†λ„ ν–¥μƒ
- π¤– **λ¨λΈ μ„ νƒ**: Huge (μ •ν™•) / Base (λΉ λ¦„) λ¨λΈ μ„ νƒ κ°€λ¥
- π” **μ΄λ―Έμ§€ μ¤ κΈ°λ¥**: ν‚¤ν¬μΈνΈ μ΄λ―Έμ§€ ν™•λ€/μ¶•μ†/μ›λ³Έ λ³µμ›
- π“ **λΉ„λ””μ¤ μ •λ³΄ ν‘μ‹**: ν•΄μƒλ„, κΈΈμ΄, FPS, μ½”λ± λ“± λΉ„λ””μ¤ μ •λ³΄ μλ™ ν‘μ‹

## μ‹μ¤ν… μ”κµ¬μ‚¬ν•­ π”§

- **μ΄μμ²΄μ **: macOS, Linux, Windows
- **Python**: 3.9 μ΄μƒ
- **GPU**: CUDA μ§€μ› GPU κ¶μ¥ (CPUλ„ μ§€μ›)
- **λ©”λ¨λ¦¬**: μµμ† 8GB RAM κ¶μ¥

## ν™κ²½ κµ¬μ„± π€

### 1. μ €μ¥μ† ν΄λ΅ 

```bash
git clone <repository-url>
cd vitpose_web
```

### 2. κ°€μƒν™κ²½ μƒμ„±

```bash
# Conda μ‚¬μ©
conda create -n vitpose python=3.9 -y
conda activate vitpose

# λλ” venv μ‚¬μ©
python -m venv vitpose_env
source vitpose_env/bin/activate  # Linux/Mac
# vitpose_env\Scripts\activate  # Windows
```

### 3. ν¨ν‚¤μ§€ μ„¤μΉ

```bash
# κΈ°λ³Έ ν¨ν‚¤μ§€ μ—…κ·Έλ μ΄λ“
pip install --upgrade pip setuptools wheel

# requirements.txtλ΅ μΌκ΄„ μ„¤μΉ
pip install -r requirements.txt
```

## μ„¤μΉ ν™•μΈ β…

VitPose λ¨λΈμ΄ μ •μƒμ μΌλ΅ importλλ”μ§€ ν™•μΈ:

```bash
python -c "from transformers import VitPoseForPoseEstimation; print('VitPose μ„¤μΉ μ™„λ£!')"
```

## μ‚¬μ©λ²• π“–

### 1. μ• ν”λ¦¬μΌ€μ΄μ… μ‹¤ν–‰

```bash
# κ°€μƒν™κ²½ ν™μ„±ν™”
conda activate vitpose  # λλ” source vitpose_env/bin/activate

# μ• ν”λ¦¬μΌ€μ΄μ… μ‹μ‘
python gradio_app.py
```

### 2. μ›Ή λΈλΌμ°μ €μ—μ„ μ ‘μ†

```
λ΅μ»¬ URL: http://127.0.0.1:7860
κ³µκ° URL: μ½μ†”μ— ν‘μ‹λλ” gradio λ§ν¬ μ‚¬μ©
```

### 3. λΉ„λ””μ¤ λ¶„μ„ κ³Όμ •

1. **λΉ„λ””μ¤ μ—…λ΅λ“**: μ™Όμ½ ν¨λ„μ—μ„ MP4 λΉ„λ””μ¤ νμΌμ„ μ—…λ΅λ“
2. **λ¨λΈ μ„ νƒ**: Huge (μ •ν™•) λλ” Base (λΉ λ¦„) λ¨λΈ μ„ νƒ
3. **ν”„λ μ„ κ°„κ²© μ„¤μ •**: μ²λ¦¬ν•  ν”„λ μ„ κ°„κ²© μ„ νƒ (κΈ°λ³Έ: 5ν”„λ μ„λ§λ‹¤)
4. **ν¬μ¦ μ¶”μ¶ μ‹μ‘**: "π€ ν¬μ¦ μ¶”μ¶ μ‹μ‘" λ²„νΌ ν΄λ¦­
5. **μ§„ν–‰μƒν™© ν™•μΈ**: ν”„λ΅κ·Έλ μ¤ λ°”λ΅ μ²λ¦¬ μ§„ν–‰λ¥  μ‹¤μ‹κ°„ ν™•μΈ
6. **ν‚¤ν¬μΈνΈ νƒμƒ‰**: μ‹κ°„ μ¬λΌμ΄λ”μ™€ μ¬μƒ λ²„νΌμΌλ΅ μ›ν•λ” μ‹μ μ ν‚¤ν¬μΈνΈ ν™•μΈ
7. **μ΄λ―Έμ§€ μ¤**: ν™•λ€/μ¶•μ†/μ›λ³Έ λ²„νΌμΌλ΅ ν‚¤ν¬μΈνΈ μƒμ„Έ ν™•μΈ
8. **λ°μ΄ν„° νƒμƒ‰**: JSON λ·°μ–΄μ—μ„ ν¬μ¦ λ°μ΄ν„° μ‹¤μ‹κ°„ νƒμƒ‰
9. **λ°μ΄ν„° λ‹¤μ΄λ΅λ“**: JSON/CSV νμΌλ΅ ν¬μ¦ λ°μ΄ν„° λ‹¤μ΄λ΅λ“

## νμΌ κµ¬μ΅° π“

```
vitpose_web/
β”β”€β”€ README.md                 # ν”„λ΅μ νΈ λ¬Έμ„
β”β”€β”€ requirements.txt          # ν¨ν‚¤μ§€ μμ΅΄μ„±
β”β”€β”€ gradio_app.py            # Gradio μ›Ή μΈν„°νμ΄μ¤ (λ©”μΈ μ•±)
β”β”€β”€ vitpose_gradio_app.py    # ν¬μ¦ λ¶„μ„ ν•µμ‹¬ λ΅μ§
β””β”€β”€ output/                  # μƒμ„±λ κ²°κ³Ό νμΌλ“¤
    β”β”€β”€ *.json              # ν¬μ¦ λ°μ΄ν„° (JSON)
    β””β”€β”€ *.csv               # ν¬μ¦ λ°μ΄ν„° (CSV)
```

## μ£Όμ” κΈ°λ¥ μƒμ„Έ π”

### ν‚¤ν¬μΈνΈ μ‹κ°ν™”
- **133κ° ν‚¤ν¬μΈνΈ**: COCO-WholeBody ν‘μ¤€ κΈ°λ°
  - π¦΄ **Body (17κ°)**: μ½”, λ, κ·€, μ–΄κΉ¨, ν”κΏμΉ, μ†λ©, μ—‰λ©μ΄, λ¬΄λ¦, λ°λ©
  - π‘¤ **Face (68κ°)**: μ–Όκµ΄ μ¤κ³½μ„ , λμΉ, λ, μ½”, μ…
  - π¤ **Left Hand (21κ°)**: μ™Όμ† κ΄€μ λ“¤
  - π¤ **Right Hand (21κ°)**: μ¤λ¥Έμ† κ΄€μ λ“¤  
  - π‘£ **Left Foot (6κ°)**: μ™Όλ° κ΄€μ λ“¤ (λ°λ ν¬ν•¨)
  - π‘£ **Right Foot (6κ°)**: μ¤λ¥Έλ° κ΄€μ λ“¤ (λ°λ ν¬ν•¨)
- **μƒ‰μƒ κµ¬λ¶„**: 
  - π”΄ λΉ¨κ°„μƒ‰: μ‚¬λ κ²€μ¶ λ°•μ¤
  - π”µ νλ€μƒ‰: λ¨λΈ μ…λ ¥ λ°•μ¤
  - πΆ λ…Ήμƒ‰: ν‚¤ν¬μΈνΈ
  - π”΄ λΉ¨κ°„μƒ‰: ν‚¤ν¬μΈνΈ μ—°κ²°μ„ 
- **μ‹ λΆ°λ„ κΈ°λ° ν•„ν„°λ§**: 0.3 μ΄μƒμ μ‹ λΆ°λ„λ¥Ό κ°€μ§„ ν‚¤ν¬μΈνΈλ§ ν‘μ‹

### μ¬μƒ λ° νƒμƒ‰ κΈ°λ¥
- **μ¬μƒ/μΌμ‹μ •μ§€**: μλ™ μ¬μƒμΌλ΅ ν‚¤ν¬μΈνΈ λ³€ν™” ν™•μΈ
- **μ‹κ°„ μ¬λΌμ΄λ”**: μ›ν•λ” μ‹μ μΌλ΅ μ¦‰μ‹ μ΄λ™
- **μ²μμΌλ΅**: λΉ„λ””μ¤ μ‹μ‘ μ§€μ μΌλ΅ μ΄λ™
- **μ΄λ―Έμ§€ μ¤**: ν™•λ€/μ¶•μ†/μ›λ³Έ λ³µμ›μΌλ΅ μƒμ„Έ ν™•μΈ

### λ°μ΄ν„° μ¶λ ¥ ν•μ‹

#### JSON ν•μ‹
```json
{
  "timestamp": 1.234,
  "frame_idx": 74,
  "persons": [
    {
      "person_id": 0,
      "keypoints": [
        {
          "id": 0,
          "name": "nose",
          "x": 320.5,
          "y": 240.3,
          "confidence": 0.95
        }
      ]
    }
  ]
}
```

#### CSV ν•μ‹
| timestamp | frame_idx | person_id | keypoint_id | keypoint_name | x | y | confidence |
|-----------|-----------|-----------|-------------|---------------|---|---|------------|
| 1.234 | 74 | 0 | 0 | nose | 320.5 | 240.3 | 0.95 |

### μ„±λ¥ μµμ ν™” κΈ°λ¥
- **μ‚¬λ κ²€μ¶ μµμ ν™”**: 30ν”„λ μ„λ§λ‹¤ μ‚¬λ κ²€μ¶ν•μ—¬ μ„±λ¥ ν–¥μƒ
- **λ°•μ¤ ν¬κΈ° μ΅°μ •**: μ΄μ „ ν”„λ μ„ λ€λΉ„ λ°•μ¤ ν¬κΈ° μµμ ν™”
- **ν”„λ μ„ κ°„κ²© μ΅°μ •**: μ‚¬μ©μκ°€ μ„ νƒ κ°€λ¥ν• ν”„λ μ„ μ²λ¦¬ κ°„κ²©
- **λ¨λΈ μ„ νƒ**: Huge (μ •ν™•) / Base (λΉ λ¦„) λ¨λΈ μ„ νƒ

## κΈ°μ  μ¤νƒ π’»

- **λ”¥λ¬λ‹**: HuggingFace Transformers, PyTorch
- **ν¬μ¦ μ¶”μ • λ¨λΈ**: 
  - Huge: `yonigozlan/synthpose-vitpose-huge-hf`
  - Base: `yonigozlan/synthpose-vitpose-base-hf`
- **μ»΄ν“¨ν„° λΉ„μ „**: OpenCV, PIL, NumPy
- **μ›Ή μΈν„°νμ΄μ¤**: Gradio 5.x
- **λ°μ΄ν„° μ²λ¦¬**: Pandas, JSON
- **μ‚¬λ κ²€μ¶**: RTDetr (PekingU/rtdetr_r50vd_coco_o365)

## λ¬Έμ  ν•΄κ²° π”§

### κ³µν†µ λ¬Έμ 

**1. VitPoseForPoseEstimation import μ¤λ¥**
```bash
# Python λ²„μ „ ν™•μΈ (3.9 μ΄μƒ ν•„μ”)
python --version

# transformers λ²„μ „ ν™•μΈ
pip show transformers
```

**2. CUDA λ©”λ¨λ¦¬ λ¶€μ΅±**
```bash
# CPU λ¨λ“λ΅ μ‹¤ν–‰ν•λ ¤λ©΄ vitpose_gradio_app.pyμ—μ„
device = "cpu"λ΅ μ„¤μ •
```

**3. Gradio νΈν™μ„± λ¬Έμ **
```bash
# μµμ‹  λ²„μ „μΌλ΅ μ—…κ·Έλ μ΄λ“
pip install --upgrade gradio gradio-client
```

### μ„±λ¥ μµμ ν™” ν

- **GPU μ‚¬μ©**: CUDA μ§€μ› GPU μ‚¬μ© μ‹ μ²λ¦¬ μ†λ„ λ€ν­ ν–¥μƒ
- **ν”„λ μ„ κ°„κ²© μ΅°μ •**: `frame_interval` κ°’μ„ λλ ¤ μ²λ¦¬ μ†λ„ ν–¥μƒ
- **Base λ¨λΈ μ‚¬μ©**: λΉ λ¥Έ μ²λ¦¬κ°€ ν•„μ”ν• κ²½μ° Base λ¨λΈ μ„ νƒ
- **ν•΄μƒλ„ μ΅°μ •**: μ…λ ¥ λΉ„λ””μ¤ ν•΄μƒλ„λ¥Ό λ‚®μ¶° λ©”λ¨λ¦¬ μ‚¬μ©λ‰ κ°μ†

## λΌμ΄μ„ μ¤ π“„

μ΄ ν”„λ΅μ νΈλ” MIT λΌμ΄μ„ μ¤ ν•μ— λ°°ν¬λ©λ‹λ‹¤.

## κΈ°μ—¬ π¤

λ²„κ·Έ λ¦¬ν¬νΈ, κΈ°λ¥ μ”μ²­, ν’€ λ¦¬ν€μ¤νΈλ¥Ό ν™μν•©λ‹λ‹¤!

## μ—…λ°μ΄νΈ λ΅κ·Έ π“

### μµμ‹  μ—…λ°μ΄νΈ (2024)
- β… Gradio 5.x μ—…κ·Έλ μ΄λ“
- β… μ‹¤μ‹κ°„ ν”„λ΅κ·Έλ μ¤ λ°” μ¶”κ°€
- β… μ΄λ―Έμ§€ μ¤ κΈ°λ¥ μ¶”κ°€
- β… λΉ„λ””μ¤ μ •λ³΄ ν‘μ‹ κΈ°λ¥ μ¶”κ°€
- β… μλ™ μ¬μƒ κΈ°λ¥ κ°μ„ 
- β… ν‚¤ν¬μΈνΈ μ •λ³΄ μ„Ήμ… μ κ±°λ΅ UI κ°„μ†ν™”
- β… κΈ°λ³Έ λ¨λΈμ„ Baseλ΅ λ³€κ²½ (λΉ λ¥Έ μ²λ¦¬)
- β… μ‚¬λ κ²€μ¶ μµμ ν™”λ΅ μ„±λ¥ ν–¥μƒ
- β… λ°λ ν‚¤ν¬μΈνΈ μ§€μ› μ¶”κ°€ 